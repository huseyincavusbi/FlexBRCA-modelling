# Flexynesis Supervised Multi-Omics Modeling: BRCA METABRIC

## Objective

This Jupyter Notebook demonstrates a supervised multi-omics analysis using Copy Number Alteration (CNA) and Gene Expression (GEX) data from the BRCA METABRIC dataset. The primary goal is to train a `DirectPred` model using the `flexynesis` framework to predict Hormone Therapy status based on the integrated omics data.

## Data

*   **Source:** BRCA METABRIC processed dataset, available for download from [MDC BIMSB](https://bimsbstatic.mdc-berlin.de/akalin/buyar/flexynesis-benchmark-datasets/brca_metabric_processed.tgz). The dataset is pre-split into training and testing sets.
*   **Data Types Used:**
    *   Copy Number Alterations (`cna.csv`)
    *   Gene Expression (`gex.csv`)
    *   Clinical Information (`clin.csv`) - used for annotations and the target variable.

## Methodology

1.  **Data Loading & Preparation:** The BRCA METABRIC dataset (CNA, GEX, Clinical) is downloaded. The `flexynesis.DataImporter` loads pre-split train/test data and performs preprocessing including imputation, variance filtering (threshold=0.8), Laplacian score feature selection (top 10%, min 100), harmonization, and normalization.
2.  **Supervised Model Training:** A `DirectPred` model is trained to predict `HORMONE_THERAPY` status from the integrated CNA and GEX data. Hyperparameters are optimized over 50 iterations using `flexynesis.HyperparameterTuning` based on validation loss with early stopping.
3.  **Evaluation & Visualization:** The best model is evaluated on the test set using standard classification metrics (AUROC, AUPR, F1, etc.). Latent space embeddings generated by the model for the test set are visualized using PCA and UMAP, colored by `HORMONE_THERAPY` status.
   
## Key Libraries

*   flexynesis
*   pandas
*   numpy
*   os

## How to Run

1.  Ensure the required libraries, especially `flexynesis` and its dependencies, are installed in your Python environment.
2.  Execute the notebook cells sequentially. The notebook will:
    *   Download and extract the data into a `brca_metabric_processed` directory.
    *   Load, preprocess, and feature-select the CNA and GEX data.
    *   Perform hyperparameter tuning for the `DirectPred` model.
    *   Train the final model with the best parameters found.
    *   Evaluate the model on the test set.
    *   Generate and display PCA and UMAP plots of the learned embeddings colored by hormone therapy status.

## Results

The notebook outputs:

*   A trained `DirectPred` model optimized for predicting hormone therapy status from multi-omics data.
*   The best hyperparameters found during the tuning process.
*   Performance metrics (balanced accuracy, F1, AUROC, AUPR, Kappa) on the test set.
*   Latent space embeddings for the test samples.
*   Visualizations (PCA, UMAP plots) of the embeddings colored by hormone therapy status, showing the model's ability to separate classes in the learned latent space.

## Acknowledgements

This project was inspired by and utilizes code structures from the BIMSB Computational Genomics 2025 course, taught by Dr. Bora Uyar, [https://github.com/BIMSBbioinfo/compgen_course_2025_module3](https://github.com/BIMSBbioinfo/compgen_course_2025_module3)). Thank you to all the instructors and contributors.

This project utilizes the `flexynesis` framework: [https://github.com/BIMSBbioinfo/flexynesis](https://github.com/BIMSBbioinfo/flexynesis)

**Citation for Flexynesis:**
Uyar, B., Savchyn, T., Wurmus, R., Sarigun, A., Shaik, M. M., Franke, V., & Akalin, A. (2024). Flexynesis: A deep learning framework for bulk multi-omics data integration for precision oncology and beyond. *bioRxiv*, 2024.07.16.603606. https://doi.org/10.1101/2024.07.16.603606

## License

This project is licensed under the MIT LICENSE - see the [LICENSE](LICENSE) file for details.
